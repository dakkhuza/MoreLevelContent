<Randomevents>
    <!-- WayStation -->
    <EventPrefabs>
        <ScriptedEvent identifier="autotrader_overdose">
            <CheckDataAction identifier="autotrader_overdose" condition="eq true">
                <Success>
                    <!-- do nothing -->
                </Success>

                <Failure>
                    <TagAction criteria="player" tag="player" />
                    <!-- Spawn in the guy -->
                    <SpawnAction npcsetidentifier="mapfeaturenpc"
                        npcidentifier="addict" spawnpointtag="autotrader"
                        spawnlocation="any" targettag="patient" SpawnPointType="Human"
                        requirespawnpointtag="true" team="FriendlyNPC" />
                    <AfflictionAction targettag="patient" affliction="opiateoverdose"
                        strength="0.6"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="opiateaddiction"
                        strength="1"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="oxygenlow"
                        strength="1"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="stun"
                        strength="0.1"
                        MultiplyByMaxVitality="true" />


                    <GodModeAction targettag="patient" enabled="true" />

                    <!-- Turn off god mode when a player gets close, go fast!! -->
                    <TriggerAction target1tag="patient" target2tag="player"
                        disableiftargetincapacitated="false"
                        radius="400" waitforinteraction="false" />
                    <GodModeAction targettag="patient" enabled="false" />

                    <SetDataAction identifier="autotrader_overdose" value="true" />

                    <ConversationAction SpeakerTag="patient"
                        text="mapfeature.autotraderoverdose.c1"
                        eventsprite="mechanic" continueconversation="true">

                        <Option text="MapFeature.autotraderoverdose.o1">
                            <ConversationAction text="MapFeature.autotraderoverdose.o1.c1" />
                            <NPCChangeTeamAction npctag="patient" teamid="Team1"
                                addtocrew="true" />
                        </Option>

                        <Option text="MapFeature.autotraderoverdose.o2">
                            <ConversationAction
                                text="MapFeature.autotraderoverdose.o2.c1" />
                        </Option>
                    </ConversationAction>
                </Failure>

            </CheckDataAction>
        </ScriptedEvent>

        <ScriptedEvent identifier="waystation1">
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="securitynpccoalition" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="watchman" spawnpointtag="waystation_admin"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="commoner" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="commoner" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

        </ScriptedEvent>

        <ScriptedEvent identifier="clownstation_preformanceofalifetime">
            <SpawnAction npcsetidentifier="mapfeaturenpc"
                npcidentifier="clownsecurity" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="mapfeaturenpc"
                npcidentifier="clownadmin" spawnpointtag="clownstation_admin"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="clown" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="clown" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

        </ScriptedEvent>

        <ScriptedEvent identifier="abyssresearch_mailman">
            <TagAction criteria="player" tag="player" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher" spawnpointtag="abyssresearch"
                spawnlocation="any" targettag="researcher"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher" spawnpointtag="abyssresearch"
                spawnlocation="any" targettag="questgiver"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="reactoroperator" spawnpointtag="abyssresearch"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="securitynpccoalition" spawnpointtag="abyssresearch"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

            <TriggerAction target1tag="questgiver" target2tag="player"
                applytotarget2="triggerer_player" radius="100" waitforinteraction="true" />
            <ConversationAction
                text="As you walk past the researcher the look up at you. Oh good you're here, finally. This is very important, make sure it arrives in once piece. They shove a bundle of papers into your arms. You try to explain you're not a mailman but they've already tuned you out. Looks like there's a location scribbled onto the front of the packet."
                invokertag="triggerer_player" endeventifinterrupted="false" />
            <SpawnAction ItemIdentifier="mailman_researchdata" TargetInventory="triggerer_player" />
            <MissionAction MissionIdentifier="gotoresearch" MinLocationDistance="2"
                CreateLocationIfNotFound="true" locationtype="Research" />
        </ScriptedEvent>

        <ScriptedEvent identifier="mailman_delivery">
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher"
                spawnlocation="Outpost" targettag="researcher"
                team="FriendlyNPC" TargetModuleTags="research" />
            <NPCWaitAction npctag="researcher" wait="true" />

            <ConversationAction text="There's an impatient looking researcher here."
                speakertag="researcher" invokertag="triggerer_player"
                endeventifinterrupted="false" eventsprite="Stuckinthemiddle1">
                <Option text="Waiting for something?">
                    <ConversationAction
                        text="He turns to look at you. Yes, actually. A devlivery crew was supposed to deliver some important research from a colleague of mine yesterday but they've been a no-show so far. I'm begining to think an abyss creature got them."
                        targettag="triggerer_player" endeventifinterrupted="false">
                        <Option text="Hand over research data.">
                            <GoTo name="check" />
                        </Option>
                        <Option text="Later." endconversation="true">
                            <GoTo name="loop" />
                        </Option>
                    </ConversationAction>
                </Option>
            </ConversationAction>

            <Label name="loop" />
            <ClearTagAction tag="triggerer_player" />
            <ConversationAction text="There's an impatient looking researcher here."
                speakertag="researcher" invokertag="triggerer_player"
                endeventifinterrupted="false" eventsprite="Stuckinthemiddle1">
                <Option text="Hand over research data.">
                    <GoTo name="check" />
                </Option>
                <Option text="Later." endconversation="true">
                    <GoTo name="loop" />
                </Option>

            </ConversationAction>

            <Label name="check" />
            <CheckItemAction itemidentifiers="mailman_researchdata" targettag="triggerer_player"
                applytagtoitem="data">
                <Failure>
                    <ConversationAction
                        text="Where did you leave that research data again?"
                        targettag="triggerer_player" />
                    <GoTo name="loop" />
                </Failure>
                <Success>
                    <GoTo name="end" />
                </Success>
            </CheckItemAction>

            <Label name="end" />
            <RemoveItemAction targettag="data" amount="1" />
            <ConversationAction
                text="He snatches the bundle of paper from your hands. Ah! This is it! This is it! So much to go through and so little time... He turns to walk away."
                targettag="triggerer_player">
                <Option text="About my payment...">
                    <ConversationAction
                        text="He lets out a groan before turning back around, You submariners, always wanting to get paid for your work, as if labor to furthur humanity isn't a reward in itself! I suppose you want marks, although.. He looks around, as if to see if anyone is listening. He leans in, I Could also part ways with whatevers in this mystery box.."
                        targettag="triggerer_player">
                        <Option text="Mystery box! Mystery box!">
                            <ConversationAction
                                text="He produces a strange box shaped object, before abruptly shoving it into your arms. It's your problem now sucker! He yells out before running away."
                                targettag="triggerer_player" IgnoreInterruptDistance="true"
                                ContinueAutomatically="true" />
                            <SpawnAction itemidentifier="psychosisartifact"
                                targetinventory="triggerer_player" />
                            <CombatAction combatmode="Retreat" isinstigator="true"
                                guardreaction="None" witnessreaction="None" npctag="researcher"
                                enemytag="triggerer_player" />
                            <ReputationAction targettype="Faction" increase="5" identifier="huskcult" />
                            <MissionStateAction missionidentifier="gotoresearch" operation="set" state="2" />
                        </Option>
                        <Option text="Marks for me, please.">
                            <ConversationAction targettag="triggerer_player"
                                text="No sense of adventure! Bah, here's your marks. I've got work to do!" />
                            <MoneyAction targettag="triggerer_player" amount="3500" />
                            <ReputationAction targettype="Faction" increase="1" identifier="huskcult" />
                            <MissionStateAction missionidentifier="gotoresearch" operation="set" state="2" />
                        </Option>
                    </ConversationAction>
                </Option>
                <Option text="What a colossal waste of time." endconversation="true">
                    <ReputationAction targettype="Faction" increase="10" identifier="huskcult" />
                    <MissionStateAction missionidentifier="gotoresearch" operation="set" state="2" />
                </Option>
            </ConversationAction>

        </ScriptedEvent>

    </EventPrefabs>
</Randomevents>