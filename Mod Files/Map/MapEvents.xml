<Randomevents>
    <!-- WayStation -->
    <EventPrefabs>
        <ScriptedEvent identifier="autotrader_overdose">
            <CheckDataAction identifier="autotrader_overdose" condition="eq true">
                <Success>
                    <!-- do nothing -->
                </Success>

                <Failure>
                    <TagAction criteria="player" tag="player" />
                    <!-- Spawn in the guy -->
                    <SpawnAction npcsetidentifier="mapfeaturenpc"
                        npcidentifier="addict" spawnpointtag="autotrader"
                        spawnlocation="any" targettag="patient" SpawnPointType="Human"
                        requirespawnpointtag="true" team="FriendlyNPC" />
                    <AfflictionAction targettag="patient" affliction="opiateoverdose"
                        strength="0.6"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="opiateaddiction"
                        strength="1"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="oxygenlow"
                        strength="1"
                        MultiplyByMaxVitality="true" />
                    <AfflictionAction targettag="patient" affliction="stun"
                        strength="0.1"
                        MultiplyByMaxVitality="true" />


                    <GodModeAction targettag="patient" enabled="true" />

                    <!-- Turn off god mode when a player gets close, go fast!! -->
                    <TriggerAction target1tag="patient" target2tag="player"
                        disableiftargetincapacitated="false"
                        radius="400" waitforinteraction="false" />
                    <GodModeAction targettag="patient" enabled="false" />

                    <SetDataAction identifier="autotrader_overdose" value="true" />

                    <ConversationAction SpeakerTag="patient"
                        text="mapfeature.autotraderoverdose.c1"
                        eventsprite="mechanic" continueconversation="true">

                        <Option text="MapFeature.autotraderoverdose.o1">
                            <ConversationAction text="MapFeature.autotraderoverdose.o1.c1" />
                            <NPCChangeTeamAction npctag="patient" teamid="Team1"
                                addtocrew="true" />
                        </Option>

                        <Option text="MapFeature.autotraderoverdose.o2">
                            <ConversationAction
                                text="MapFeature.autotraderoverdose.o2.c1" />
                        </Option>
                    </ConversationAction>
                </Failure>

            </CheckDataAction>
        </ScriptedEvent>

        <ScriptedEvent identifier="waystation1">
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="securitynpccoalition" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="watchman" spawnpointtag="waystation_admin"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="commoner" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="commoner" spawnpointtag="waystation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

        </ScriptedEvent>

        <ScriptedEvent identifier="clownstation_preformanceofalifetime">
            <SpawnAction npcsetidentifier="mapfeaturenpc"
                npcidentifier="clownsecurity" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="mapfeaturenpc"
                npcidentifier="clownadmin" spawnpointtag="clownstation_admin"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="clown" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="clown" spawnpointtag="clownstation"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

        </ScriptedEvent>

        <ScriptedEvent identifier="abyssresearch_mailman">
            <TagAction criteria="player" tag="player" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher" spawnpointtag="abyssresearch"
                spawnlocation="any" targettag="researcher"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher" spawnpointtag="abyssresearch"
                spawnlocation="any" targettag="questgiver"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="reactoroperator" spawnpointtag="abyssresearch"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="securitynpccoalition" spawnpointtag="abyssresearch"
                spawnlocation="any"
                requirespawnpointtag="true" team="FriendlyNPC" />

            <TriggerAction target1tag="questgiver" target2tag="player"
                applytotarget2="triggerer_player" radius="100" waitforinteraction="true" />
            <ConversationAction
                text="MapFeature.abyssresearch.c1"
                invokertag="triggerer_player" endeventifinterrupted="false" />
            <SpawnAction ItemIdentifier="mailman_researchdata" TargetInventory="triggerer_player" />
            <MissionAction MissionIdentifier="gotoresearch" MinLocationDistance="2"
                CreateLocationIfNotFound="true" locationtype="Research" />
        </ScriptedEvent>

        <ScriptedEvent identifier="mailman_delivery">
            <SpawnAction npcsetidentifier="outpostnpcs1"
                npcidentifier="researcher"
                spawnlocation="Outpost" targettag="researcher"
                team="FriendlyNPC" TargetModuleTags="research" />
            <NPCWaitAction npctag="researcher" wait="true" />

            <ConversationAction text="MapFeature.mailman.impatient"
                speakertag="researcher" invokertag="triggerer_player"
                endeventifinterrupted="false" eventsprite="Stuckinthemiddle1">
                <Option text="MapFeature.mailman.waiting">
                    <ConversationAction
                        text="MapFeature.mailman.exposition"
                        targettag="triggerer_player" endeventifinterrupted="false">
                        <Option text="MapFeature.mailman.handover">
                            <GoTo name="check" />
                        </Option>
                        <Option text="MapFeature.mailman.later" endconversation="true">
                            <GoTo name="loop" />
                        </Option>
                    </ConversationAction>
                </Option>
            </ConversationAction>

            <Label name="loop" />
            <ClearTagAction tag="triggerer_player" />
            <ConversationAction text="MapFeature.mailman.impatient"
                speakertag="researcher" invokertag="triggerer_player"
                endeventifinterrupted="false" eventsprite="Stuckinthemiddle1">
                <Option text="MapFeature.mailman.handover">
                    <GoTo name="check" />
                </Option>
                <Option text="MapFeature.mailman.later" endconversation="true">
                    <GoTo name="loop" />
                </Option>

            </ConversationAction>

            <Label name="check" />
            <CheckItemAction itemidentifiers="mailman_researchdata" targettag="triggerer_player"
                applytagtoitem="data">
                <Failure>
                    <ConversationAction
                        text="MapFeature.mailman.missing"
                        targettag="triggerer_player" />
                    <GoTo name="loop" />
                </Failure>
                <Success>
                    <GoTo name="end" />
                </Success>
            </CheckItemAction>

            <Label name="end" />
            <RemoveItemAction targettag="data" amount="1" />
            <ConversationAction
                text="MapFeature.mailman.snatch"
                targettag="triggerer_player">
                <Option text="MapFeature.mailman.payment">
                    <ConversationAction
                        text="MapFeature.mailman.groan"
                        targettag="triggerer_player">
                        <Option text="MapFeature.mailman.box">
                            <!-- Take the box -->
                            <ConversationAction
                                text="MapFeature.mailman.sucker"
                                targettag="triggerer_player" IgnoreInterruptDistance="true"
                                ContinueAutomatically="true" />
                            <SpawnAction itemidentifier="psychosisartifact"
                                targetinventory="triggerer_player" />
                            <CombatAction combatmode="Retreat" isinstigator="true"
                                guardreaction="None" witnessreaction="None" npctag="researcher"
                                enemytag="triggerer_player" />
                            <ReputationAction targettype="Faction" increase="5"
                                identifier="huskcult" />
                            <MissionStateAction missionidentifier="gotoresearch" operation="set"
                                state="2" />
                        </Option>
                        <Option text="MapFeature.mailman.marks">
                            <ConversationAction targettag="triggerer_player"
                                text="MapFeature.mailman.lame" />
                            <MoneyAction targettag="triggerer_player" amount="3500" />
                            <ReputationAction targettype="Faction" increase="1"
                                identifier="huskcult" />
                            <MissionStateAction missionidentifier="gotoresearch" operation="set"
                                state="2" />
                        </Option>
                    </ConversationAction>
                </Option>
                <Option text="MapFeature.mailman.wasteoftime" endconversation="true">
                    <ReputationAction targettype="Faction" increase="10" identifier="huskcult" />
                    <MissionStateAction missionidentifier="gotoresearch" operation="set" state="2" />
                </Option>
            </ConversationAction>

        </ScriptedEvent>

    </EventPrefabs>
</Randomevents>